# 自研密码管理工具设计

## 背景

- 不同的站点、应用都有不同的账号、密码，时间长了容易忘记
- 市面上的密码管理工具基本都是收费的
- 明文存储账号密码在笔记软件中存在安全风险

## 核心思路

实现一个加解密工具，用户将整理好的所有账号密码输入，通过强主密码加密，然后可以安全地存储在任何位置（如语雀、飞书等）。

## 安全考虑

1. **简单加盐加密的不足**
   - 简单的加盐可能容易被暴力破解，特别是如果盐值固定或加密算法选择不当
   - 现代密码攻击者可使用GPU加速破解，每秒可尝试数十亿种组合
   - 如果加密方式过于简单，即使加盐也可能被逆向工程

2. **密钥管理风险**
   - 若用户忘记主密码，所有数据将永久无法恢复
   - 若主密码过于简单(如生日、名字)，安全性大大降低
   - 密钥的安全存储和管理是整个系统的核心

3. **加密算法选择**
   - 自行实现的加密算法通常存在安全漏洞
   - 需使用经过验证的标准(如AES-256)确保安全性

## 最小闭环方案

### 1. 核心功能

- **加密功能**：将密码数据转换为安全密文
- **解密功能**：使用正确密钥恢复原始数据
- **数据格式化**：统一数据存储格式，便于检索

### 2. 加密实现

- 使用**AES-256-GCM**加密算法
- 采用**PBKDF2**密钥派生函数，迭代次数≥100,000
- 为每个数据文件生成随机**盐值**和**初始化向量(IV)**

### 3. 用户流程

**首次使用**：
1. 用户创建强主密码
2. 系统生成随机盐值
3. 使用PBKDF2派生加密密钥
4. 加密用户的账号密码数据
5. 存储加密数据、盐值和IV（但不存储主密码）

**日常使用**：
1. 用户输入主密码
2. 系统读取存储的盐值，重新派生密钥
3. 使用密钥解密数据
4. 用户查看/编辑数据
5. 关闭程序时重新加密数据

### 4. 数据存储格式

```json
{
  "metadata": {
    "salt": "base64编码的盐值",
    "iv": "base64编码的初始化向量",
    "iterations": 100000,
    "version": "1.0"
  },
  "encrypted_data": "base64编码的加密数据"
}
```

### 5. 安全措施

- 内存中解密数据定时清除
- 剪贴板内容自动清除（密码复制后30秒）
- 主密码强度检测
- 无网络通信，纯本地操作

## 强主密码示例

强主密码应具备：长度、复杂性、随机性和可记忆性。

### 示例1：使用随机字符
```
jK8$p2Qr#7LmZ!9vB
```
- 18个字符
- 混合大小写字母、数字和特殊符号
- 完全随机，无规律可循

### 示例2：密码短语法
```
狮子%跳过6把@蓝色雨伞!
```
- 使用中文词汇增加复杂度
- 加入数字和特殊符号
- 容易记忆但难以猜测

### 示例3：替换法
```
Ch4ng3_Y0ur_P@$$w0rd_2024!
```
- 基于句子"Change Your Password 2024!"
- 字母替换为数字和符号
- 保持可读性的同时增加复杂度

### 示例4：多词组合法
```
正确#电池59-马匹@树叶
```
- 随机词语组合
- 添加特殊符号和数字
- 无逻辑关联，但可创造记忆助记

## 强主密码与盐值的区别

### 强主密码
- **由用户创建和记忆**的秘密
- 用于**生成**实际加密密钥
- 不存储在系统中，只存在于用户记忆中
- 是整个加密系统的**安全基础**
- 丢失意味着数据**无法恢复**
- 用户每次使用系统都需要输入

### 盐值
- 系统**随机生成**的数据
- **可以存储**在加密数据旁边，不需保密
- 防止相同密码产生相同的加密结果
- 防止彩虹表攻击和预计算攻击
- 每个用户或每个文件应有**不同盐值**
- 用户不需要记忆或输入

## 完整的账号密码管理流程

### 1. 明文收集阶段
- 用户可以在**本地文本文件**中临时整理账号密码
- 建议使用**离线设备**或**断网环境**收集
- 格式可以是JSON、CSV或自定义文本格式
- 这个明文文件是**临时的**，加密后应安全删除

### 2. 加密处理阶段
- 打开自研密码工具
- 输入强主密码创建加密环境
- 导入临时明文数据文件
- 工具执行加密处理
- 输出加密后的密文文件

### 3. 存储和使用
- 加密后的密文可安全存储在：
  - 笔记软件（语雀、飞书等）
  - 云盘
  - 本地文件系统
- **删除原始明文文件**（最好使用安全删除工具）

### 4. 查看时的流程
- 打开密码工具
- 导入加密文件
- 输入主密码
- 临时解密查看所需信息
- 关闭工具后，内存中的明文数据消失

### 5. 更新密码时
- 打开工具，解密现有文件
- 修改或添加账号信息
- 重新加密保存
- 更新存储的密文文件

## 数据结构建议

```json
[
  {
    "网站/应用": "xx银行",
    "网址": "https://bank.example.com",
    "用户名": "zhang_san",
    "密码": "密码内容",
    "备注": "信用卡账号",
    "创建日期": "2024-01-01",
    "上次修改": "2024-06-01"
  },
  {
    "网站/应用": "社交媒体A",
    "网址": "https://social.example.com",
    "用户名": "user123",
    "密码": "密码内容",
    "备注": "工作账号"
  }
]
```

## 后续开发计划

1. 实现基础加解密功能
2. 添加用户界面
3. 实现数据导入导出
4. 增强安全特性（密码强度检测、自动清除等）
5. 支持多平台（桌面、移动端） 